# Web版 Claude Code メインツール化 検討レポート

**作成日**: 2026-02-16  
**目的**: DTアプリ「コード」機能をCLI代替のメインツールとして運用する戦略の設計  
**前提**: スマホから操作可能であることが最大の動機  

---

## 1. 方針転換の整理

### 現行（CLI-first）

```
DT（PC） → CLI Codex → ローカルワークツリー → git push
         → Claude Chat（GitHub MCP） → ドキュメント・PR管理
```

### 新方針（Web版-first）

```
DT（スマホ） → Web版 Claude Code → リモートリポジトリ直接操作
            → Claude Chat（GitHub MCP） → PR・マージ・ドキュメント
            → PC は視覚確認のみ（必要時）
```

### 方針転換で変わること

| 観点 | CLI-first | Web版-first |
|------|-----------|-------------|
| 起動場所 | PC必須 | スマホで完結可能 |
| ブランチ管理 | ワークツリーで即利用 | 毎回 `git fetch` が必要 |
| 視覚確認 | localhost で即時 | GitHub Pages デプロイ後 or PC |
| GitHub連携 | `gh` CLI 利用可能 | 不可。Chat側GitHub MCPで補完 |
| コミット先 | 指定ブランチ | `claude/*` 自動生成（制御可能） |
| 並列作業 | 複数ワークツリー同時 | 1セッション1タスク |

---

## 2. 既存タスクの仕分け

### ✅ Web版向き（スマホから投入可能）

| ID | タスク | サイズ | 理由 |
|----|--------|--------|------|
| T-040-11 | Read More トグルボタン | M | JS ロジックのみ。検証済み |
| T-040-08 | API 接続切り替え | S | JS の fetch URL 変更 |
| T-040-12 | 指示書テンプレート改善 | S | ドキュメント作成 |
| T-040-13 | 検証ブランチ掃除 | S | git コマンドのみ |
| T-016 | Uniform管理の一元化 | M | JS リファクタリング。視覚変更なし |
| T-017 | devパラメータレジストリ化 | M | JS リファクタリング。T-016とセット |
| T-019 | main.js責務分割 | L | JS ファイル分割。視覚変更なし |
| T-021 | nav-objects.js分割 | M | JS ファイル分割。視覚変更なし |
| T-022 | dev-panel.js UI/Controller分離 | M | JS リファクタリング |
| T-038 | devlog.yml CI再有効化 | S | YAML設定変更 |
| T-042 | ワークツリー同期チェック機能 | M | ドキュメント・スクリプト |
| T-006 | English PDF作成 | M | コンテンツ作成 |
| T-012 | 欠損データ構造設計 | L | 設計ドキュメント |

### ⚠️ 条件付き（工夫すれば可能）

| ID | タスク | サイズ | 条件 |
|----|--------|--------|------|
| T-018 | CSS所在整理 | M | ファイル移動のみなら可。視覚確認はGitHub Pagesで後追い |
| T-040-00a | pjdhiro JSON API配置 | S | 別リポジトリ操作。GitHub MCPで可能 |
| T-025 | ビルドツール導入検討 | L | 調査・ドキュメントは可。実装テストはPC |

### ❌ Web版不向き（PC作業推奨）

| ID | タスク | サイズ | 理由 |
|----|--------|--------|------|
| T-043 | devlog遷移UX改善 | M | アニメーション・CSS。即時視覚確認が必須 |
| T-007 | パフォーマンスプロファイリング | M | DevTools・FPS計測が必要 |
| T-015 | モバイル実機テスト検証 | S | 物理デバイスでの動作確認・エッジケース |
| T-011 | 音響の検討 | L | 音声再生の確認が必要 |
| T-045 | devlog背景にThree.js検討 | M | シェーダー・3D描画の視覚確認 |

### 仕分けサマリ

```
Web版向き:    13タスク（全体の 54%）
条件付き:      3タスク（全体の 13%）
PC推奨:        8タスク（全体の 33%）
```

**注**: この仕分けは v1。DT の指摘により v2（ANALYSIS-dt-code-first.md）で大幅修正。

---

## 3. スマホ運用ワークフロー設計

### 3-1. 全体フロー

```
[スマホ] DT → 指示書作成 or タスク指定
              ↓
[スマホ] Claude Chat（本プロジェクト） → TODO確認・指示書生成・pushまで
              ↓
[スマホ] DTアプリ「コード」→ 指示書に基づき実装
              ↓
[スマホ] Claude Chat → diff確認・マージ・TODO更新
              ↓
[任意]   GitHub Pages で視覚確認（スマホブラウザ or PC）
```

### 3-2. 役割分担（新体制）

| 役割 | 担当 | 操作場所 |
|------|------|----------|
| 戦略・判断 | DT | スマホ |
| 指示書作成・TODO管理 | Claude Chat（GitHub MCP） | スマホ |
| コード実装 | Web版 Claude Code | スマホ |
| PR作成・マージ | Claude Chat（GitHub MCP） | スマホ |
| 視覚確認（JS系） | 不要 or GitHub Pages | スマホ |
| 視覚確認（CSS/UI系） | DT | PC or スマホブラウザ |
| シェーダー実装 | Gemini MCP + PC Claude | PC |

### 3-3. ブランチ戦略の変更

**現行**: feature/* ワークツリー → main マージ

**新方針**:

- **小タスク（S/M）**: Web版で main 直接作業（指示書で `git checkout main` 明記）
- **大タスク（L/XL）**: Web版で feature/* ブランチ作業 → Chat側でマージ
- **claude/* 自動ブランチ**: 原則使わない。指示書でブランチを明示指定

### 3-4. 視覚確認の代替手段

Web版ではブラウザプレビューが使えないため:

1. **JS ロジック系**: E2Eテスト（`?test`）で自動検証。視覚確認不要
2. **CSS 軽微変更**: GitHub Pages デプロイ後にスマホブラウザで確認（1-2分遅延）
3. **CSS 大規模変更**: PC 作業に回す（T-043 など）
4. **シェーダー**: 従来通り PC + Gemini MCP

### 3-5. 重複レポート問題への対策

前回セッションで発生した「同一レポートの重複提出」を防ぐ:

- **指示書に一意ID**: 各指示にタスクID（T-XXX-YY）を含める
- **コミットメッセージ規約**: `feat(T-040-11): ...` 形式で、完了済みかgit logで判定可能
- **Chat側での事前チェック**: タスク投入前に `git log --oneline -10` でコミット履歴を確認

---

## 4. 指示書テンプレート v2（Web版対応）

→ ANALYSIS-dt-code-first.md §エージェント4 で更新済み。NEXT-TASK.md 方式に発展。

---

## 5. TODO 追加提案

| ID | タスク | 優先度 | サイズ | カテゴリ |
|----|--------|--------|--------|----------|
| T-046 | WORKFLOW.md にWeb版運用フローを追記 | P1 | S | プロセス |
| T-047 | 指示書テンプレート v2 を docs/prompts/ に配置 | P1 | S | プロセス |
| T-048 | リファクタリング一括投入指示書作成（T-016/017/019/021/022） | P2 | M | プロセス |

---

## 6. リスクと軽減策

| リスク | 影響 | 軽減策 |
|--------|------|--------|
| Web版のコンテキスト上限 | 大タスクが途中で切れる | タスクをS/M単位に分割。L以上はPC |
| セッション切断 | 作業途中のコードが消失 | こまめなコミット指示を指示書に含める |
| ブランチ衝突 | Chat側とWeb版で同時編集 | 1タスク1ブランチ原則。並列禁止 |
| 視覚バグ見落とし | CSSリグレッション | E2Eテスト拡充 + GitHub Pagesでの目視確認 |
| 指示書の品質依存 | 曖昧な指示で実装ミス | テンプレート遵守 + Chat側でレビュー |

---

## 参照

- `docs/RESEARCH-web-claude-code.md` — 初回検証レポート
- `docs/ANALYSIS-dt-code-first.md` — 多角分析（本レポートの発展版）
- `docs/TODO-kesson-articles.md` — T-040 タスク詳細
- `docs/TODO.md` — 全タスクバックログ
- `docs/WORKFLOW.md` — 現行ワークフロー
